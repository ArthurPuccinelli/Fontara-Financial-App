<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Status da Assinatura - Fontara Financial</title>
    <meta
      name="description"
      content="Status da sua operação de assinatura com Fontara Financial."
    />
    <link
      rel="shortcut icon"
      href="../assets/logo/logo.png" 
      type="image/x-icon"
    />
    <link rel="stylesheet" href="../css/tailwind-build.css" />
    <link rel="stylesheet" href="../css/index.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.3/font/bootstrap-icons.min.css"
      integrity="sha512-dPXYcDub/aeb08c63jRq/k6GaKccl256JQy/AnOq7CAnEZ9FzSL9wSbcZkMp4R26vBsMLFYH4kQ67/bbV8XaCQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <style>
      .thank-you-container {
        min-height: 80vh;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
      }
      .logo-agradecimento {
        max-width: 150px;
        margin-bottom: 2rem;
      }
      .footer-theme-toggle {
        padding: 0.5rem;
        border-radius: 0.375rem;
        transition: background-color 0.2s;
        cursor: pointer;
      }
      .footer-theme-toggle:hover {
        background-color: rgba(128, 128, 128, 0.1);
      }
    </style>
    <script>
      // Força tema claro o mais cedo possível
      (function() {
        document.documentElement.classList.remove('tw-dark');
      })();
    </script>
  </head>
  <body
    class="tw-flex tw-min-h-[100vh] tw-flex-col tw-bg-[#fcfcfc] tw-text-black dark:tw-bg-black dark:tw-text-white"
  >
    <main class="tw-pt-10 tw-pb-10 tw-px-[5%] lg:tw-px-[10%] tw-flex-grow">
      <section class="tw-container tw-mx-auto thank-you-container">
        <div> 
          <img 
            src="../assets/logo/logo.png" 
            alt="Fontara Financial Logo" 
            class="logo-agradecimento dark:tw-invert"
          />
          <div class="tw-bg-white dark:tw-bg-[#171717] tw-p-8 md:tw-p-12 tw-rounded-xl tw-shadow-lg tw-max-w-2xl tw-w-full">
            <div id="statusIconContainer" class="tw-text-center tw-mb-8">
              {/* O ícone será inserido aqui pelo JS */}
            </div>
            <h1 id="agradecimentoTitulo" class="tw-text-3xl md:tw-text-4xl tw-font-semibold tw-text-center tw-mb-4">
              {/* O título será preenchido pelo JS */}
            </h1>
            <div id="docusignStatusMessage" class="tw-text-lg tw-text-center tw-mb-6">
              {/* A mensagem de status será preenchida pelo JS */}
            </div>
            <p id="complementaryMessage" class="tw-text-md tw-text-gray-600 dark:tw-text-gray-400 tw-text-center tw-mb-8">
              {/* Mensagem complementar opcional */}
            </p>
            <div class="tw-text-center">
              <a href="../index.html" class="btn tw-inline-flex tw-items-center tw-gap-3 tw-px-6 tw-py-3 tw-text-lg">
                <i class="bi bi-house-door-fill"></i>
                <span>Acessar o portal Fontara</span>
              </a>
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer class="tw-mt-auto tw-flex tw-flex-col tw-w-full tw-gap-4 tw-text-sm tw-pt-[5%] tw-pb-10 tw-px-[5%] md:tw-px-[10%] tw-text-black dark:tw-text-white">
      <div class="tw-flex max-md:tw-flex-col max-md:tw-gap-6 tw-gap-3 tw-w-full tw-place-content-around tw-items-center">
        <div class="tw-flex tw-h-full tw-w-auto md:tw-w-[250px] tw-flex-col tw-place-items-center tw-gap-6 max-md:tw-w-full">
          <a href="../index.html" class="tw-w-full tw-place-items-center tw-flex tw-flex-col tw-gap-6">
            <img src="../assets/logo/logo.png" alt="Fontara Financial Logo" class="tw-max-w-[120px] dark:tw-invert"/>
          </a>
          <div class="tw-flex tw-gap-4 tw-text-lg">
            <a href="https://github.com/PaulleDemon/" aria-label="Github" target="_blank" rel="noopener"><i class="bi bi-github"></i></a>
            <a href="https://twitter.com/pauls_freeman" aria-label="Twitter" target="_blank" rel="noopener"><i class="bi bi-twitter"></i></a>
            <a href="https://www.linkedin.com/" aria-label="Linkedin" target="_blank" rel="noopener"><i class="bi bi-linkedin"></i></a>
          </div>
        </div>
        <div class="tw-flex max-md:tw-flex-col tw-flex-wrap tw-gap-6 tw-h-full tw-w-full tw-justify-around md:tw-w-auto">
          <div class="tw-flex tw-h-full tw-w-auto md:tw-w-[200px] tw-flex-col tw-gap-4 max-md:tw-items-center"><h2 class="tw-text-xl">Recursos</h2><div class="tw-flex tw-flex-col tw-gap-3 max-md:tw-items-center"><a href="../index.html#nossos-servicos" class="footer-link">Nossos Serviços</a><a href="../index.html#faq" class="footer-link">FAQ</a><a href="#" class="footer-link">Blog Financeiro</a></div></div>
          <div class="tw-flex tw-h-full tw-w-auto md:tw-w-[200px] tw-flex-col tw-gap-4 max-md:tw-items-center"><h2 class="tw-text-xl">Fontara</h2><div class="tw-flex tw-flex-col tw-gap-3 max-md:tw-items-center"><a href="#" class="footer-link">Sobre Nós</a><a href="#" class="footer-link">Fale Conosco</a></div></div>
          <div class="tw-flex tw-h-full tw-w-auto md:tw-w-[200px] tw-flex-col tw-gap-4 max-md:tw-items-center"><h2 class="tw-text-xl">Legal</h2><div class="tw-flex tw-flex-col tw-gap-3 max-md:tw-items-center"><a href="#" class="footer-link">Termos de Uso</a><a href="#" class="footer-link">Política de Privacidade</a></div></div>
        </div>
      </div>
      <hr class="tw-mt-8" />
      <div class="tw-mt-4 tw-flex tw-flex-col md:tw-flex-row tw-gap-4 tw-text-gray-700 dark:tw-text-gray-300 tw-place-items-center tw-text-[12px] tw-w-full tw-text-center tw-justify-between">
        <div class="tw-order-2 md:tw-order-1">
          <span>Copyright &#169; 2023-<span id="current-year"></span> Fontara Financial. Todos os direitos reservados.</span><br>
          <span>Todas as marcas registradas e direitos autorais pertencem aos seus respectivos proprietários.</span>
        </div>
        <div class="tw-order-1 md:tw-order-2">
          <button type="button" onclick="toggleMode()" class="footer-theme-toggle tw-text-gray-600 dark:tw-text-gray-300 tw-text-xl" title="Alternar tema" id="theme-toggle">
            <i class="bi" id="toggle-mode-icon"></i>
          </button>
        </div>
      </div>
    </footer>

    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const yearSpan = document.getElementById('current-year');
        if (yearSpan) yearSpan.textContent = new Date().getFullYear();

        const urlParams = new URLSearchParams(window.location.search);
        const recipientNameParam = urlParams.get('recipientName');
        const eventStatus = urlParams.get('event');
        // const envelopeId = urlParams.get('envelopeId'); // Disponível se você precisar usar

        const agradecimentoTitulo = document.getElementById('agradecimentoTitulo');
        const statusIconContainer = document.getElementById('statusIconContainer');
        const docusignStatusMessage = document.getElementById('docusignStatusMessage');
        const complementaryMessage = document.getElementById('complementaryMessage'); // Novo elemento para mensagens adicionais

        let nomeCliente = "Cliente"; // Padrão
        if (recipientNameParam) {
          nomeCliente = decodeURIComponent(recipientNameParam.replace(/\+/g, ' '));
        }
        
        let iconHtml = '<i class="bi bi-info-circle-fill tw-text-6xl tw-text-blue-500"></i>'; // Ícone padrão
        let tituloPrincipal = `Obrigado, <span class="tw-text-blue-600 dark:tw-text-blue-400">${nomeCliente}</span>!`;
        let statusMsg = "Sua operação com a Fontara Financial foi processada.";
        let compMsg = "Em breve, você receberá mais informações em seu e-mail.";

        if (eventStatus === 'signing_complete') {
          iconHtml = '<i class="bi bi-check-circle-fill tw-text-6xl tw-text-green-500"></i>';
          tituloPrincipal = `Documento Assinado, <span class="tw-text-blue-600 dark:tw-text-blue-400">${nomeCliente}</span>!`;
          statusMsg = "Seu documento foi assinado com sucesso.";
          compMsg = "Agradecemos por escolher a Fontara Financial. Uma cópia do documento assinado será enviada para o seu e-mail."
        } else if (eventStatus === 'decline') {
          iconHtml = '<i class="bi bi-x-octagon-fill tw-text-6xl tw-text-red-500"></i>';
          tituloPrincipal = "Processo Interrompido";
          statusMsg = "O processo de assinatura foi recusado.";
          compMsg = "Se isso foi um engano, por favor, entre em contato com nosso suporte ou tente novamente a operação.";
        } else if (eventStatus === 'cancel' || eventStatus === 'session_timeout' || eventStatus === 'ttl_expired') {
          iconHtml = '<i class="bi bi-exclamation-triangle-fill tw-text-6xl tw-text-yellow-500"></i>';
          tituloPrincipal = "Sessão de Assinatura Expirada/Cancelada";
          statusMsg = `Sua sessão de assinatura foi ${eventStatus === 'cancel' ? 'cancelada' : 'encerrada'}.`;
          compMsg = "Você pode tentar iniciar o processo de assinatura novamente, se necessário.";
        } else if (eventStatus) { // Outros eventos genéricos do Docusign
            statusMsg = `O status do seu envelope é: ${eventStatus}.`;
            compMsg = "Para mais detalhes, verifique seu e-mail ou entre em contato conosco."
        }

        if(statusIconContainer) statusIconContainer.innerHTML = iconHtml;
        if(agradecimentoTitulo) agradecimentoTitulo.innerHTML = tituloPrincipal;
        if(docusignStatusMessage) docusignStatusMessage.textContent = statusMsg;
        if(complementaryMessage) complementaryMessage.textContent = compMsg;

        // Lógica de tema (do index.js, mas garantindo que o botão seja atualizado)
        // O script inline no <head> já tentou forçar o tema claro.
        // O index.js (carregado abaixo) definirá o tema com base no localStorage/preferência.
        // Depois disso, precisamos garantir que o ícone do botão no rodapé esteja correto.
        if (typeof window.updateToggleModeBtn === "function") {
            // Pequeno delay para garantir que o index.js tenha tido chance de rodar primeiro
            setTimeout(window.updateToggleModeBtn, 0);
        } else {
            // Fallback caso updateToggleModeBtn não esteja globalmente acessível de imediato
            const toggleIcon = document.querySelector("#toggle-mode-icon");
            if(toggleIcon) {
                if(document.documentElement.classList.contains('tw-dark')) {
                    toggleIcon.classList.add("bi-moon-stars-fill");
                    toggleIcon.classList.remove("bi-sun");
                } else {
                    toggleIcon.classList.add("bi-sun");
                    toggleIcon.classList.remove("bi-moon-stars-fill");
                }
            }
        }
      });
    </script>
    <script src="../scripts/index.js"></script>
  </body>
</html>